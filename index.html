<html>
  <head>
    <script>
      (function (u, n, i, v, e, r, s, a, l) {
        u[r] = {};
        u[r].uid = "029907d3-4b00-4dd4-bcc4-3257b8e2de80";
        u[r].m = [
          "getReferrerInfo",
          "identify",
          "integrationsReady",
          "on",
          "ready",
          "track",
        ];
        u[r].queue = [];
        u[r].f = function (t) {
          return function () {
            var l = Array.prototype.slice.call(arguments);
            l.unshift(t);
            u[r].queue.push(l);
            return u[r].queue;
          };
        };
        for (var t = 0; t < u[r].m.length; t++) {
          l = u[r].m[t];
          u[r][l] = u[r].f(l);
        }
        a = n.createElement(v);
        a.src = e + "/us-" + u[r].uid + ".js";
        a.async = s;
        n.getElementsByTagName(i)[0].appendChild(a);
      })(
        window,
        document,
        "head",
        "script",
        "https://cdn.getambassador.com",
        "mbsy",
        true
      );
    </script>
    <script>
      function mbsyUpdateForm() {
        mbsy.getReferrerInfo(function (referrerData) {
          var mbsyInterval = setInterval(function () {
            var mbsyShortCodeField = document.getElementById("short_code");
            var mbsyCampaignUidField = document.getElementById("campaign_uid");
            if (mbsyShortCodeField && mbsyCampaignUidField) {
              mbsyShortCodeField.value = referrerData.shortCode;
              mbsyCampaignUidField.value = referrerData.campaign;
              clearInterval(mbsyInterval);
            }
          }, 100);
        });
      }
      mbsyUpdateForm();
    </script>
  </head>
  <body>
    <center>
      <h3>Sign Up to Test This Integration!</h3>
      <form id="formId" onsubmit="sendCommission(event)" name="formId" >
        <input id="email" type="email" name="email" />
        <input id="short_code" type="hidden" value="" name="short_code" />
        <input id="campaign_uid" type="hidden" value="" name="campaign_uid" />
        <input type="submit" />
      </form>
    </center>
    <script>
      function sendCommission(event) {
        event.preventDefault();
        const form = document.getElementById("formId");
        const formData = new FormData(form);
        const email = formData.get('email');
        const short_code = formData.get('short_code');
        const campaign_uid = formData.get("campaign_uid");
        mbsy.identify({email: email, sandbox:true});
        mbsy.track({campaign: campaign_uid, revenue: 0, commissionApproved: true })
      }
    </script>
  </body>
</html>
